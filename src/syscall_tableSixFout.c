#include "../incl/ft_strace.h"
#include "../lib/printf/ft_printf.h"

//find /usr/include -name "unistd_64.h"

t_syscall_entry g_syscall_table_64[] = {
    [0] = {"read", {INT, POINTER, INT}},
    [1] = {"write", {INT, POINTER, INT}},
    [2] = {"open", {STRING, INT, INT}},
    [3] = {"close", {INT}},
    [4] = {"stat", {STRING, POINTER}},
    [5] = {"fstat", {INT, POINTER}},
    [6] = {"lstat", {STRING, POINTER}},
    [7] = {"poll", {POINTER, INT, INT}},
    [8] = {"lseek", {INT, INT, INT}},
    [9] = {"mmap", {POINTER, INT, INT, INT, INT, INT}},
    [10] = {"mprotect", {POINTER, INT, INT}},
    [11] = {"munmap", {POINTER, INT}},
    [12] = {"brk", {POINTER}},
    [13] = {"rt_sigaction", {INT, POINTER, POINTER, INT}},
    [14] = {"rt_sigprocmask", {INT, POINTER, POINTER, INT}},
    [15] = {"rt_sigreturn", {VOID}},
    [16] = {"ioctl", {INT, INT, POINTER}},
    [17] = {"pread64", {INT, POINTER, INT, INT}},
    [18] = {"pwrite64", {INT, POINTER, INT, INT}},
    [19] = {"readv", {INT, POINTER, INT}},
    [20] = {"writev", {INT, POINTER, INT}},
    [21] = {"access", {STRING, INT}},
    [22] = {"pipe", {POINTER}},
    [23] = {"select", {INT, POINTER, POINTER, POINTER, POINTER}},
    [24] = {"sched_yield", {VOID}},
    [25] = {"mremap", {POINTER, INT, INT, INT}},
    [26] = {"msync", {POINTER, INT, INT}},
    [27] = {"mincore", {POINTER, INT, POINTER}},
    [28] = {"madvise", {POINTER, INT, INT}},
    [29] = {"shmget", {INT, INT, INT}},
    [30] = {"shmat", {INT, STRING, INT}},
    [31] = {"shmctl", {INT, INT, POINTER}},
    [32] = {"dup", {INT}},
    [33] = {"dup2", {INT, INT}},
    [34] = {"pause", {VOID}},
    [35] = {"nanosleep", {POINTER, POINTER}},
    [36] = {"getitimer", {INT, POINTER}},
    [37] = {"alarm", {INT}},
    [38] = {"setitimer", {INT, POINTER, POINTER}},
    [39] = {"getpid", {VOID}},
    [40] = {"sendfile", {INT, INT, POINTER, INT}},
    [41] = {"socket", {INT, INT, INT}},
    [42] = {"connect", {INT, POINTER, INT}},
    [43] = {"accept", {INT, POINTER, POINTER}},
    [44] = {"sendto", {INT, POINTER, INT, INT, POINTER, INT}},
    [45] = {"recvfrom", {INT, POINTER, INT, INT, POINTER, POINTER}},
    [46] = {"sendmsg", {INT, POINTER, INT}},
    [47] = {"recvmsg", {INT, POINTER, INT}},
    [48] = {"shutdown", {INT, INT}},
    [49] = {"bind", {INT, POINTER, INT}},
    [50] = {"listen", {INT, INT}},
    [51] = {"getsockname", {INT, POINTER, POINTER}},
    [52] = {"getpeername", {INT, POINTER, POINTER}},
    [53] = {"socketpair", {INT, INT, INT, POINTER}},
    [54] = {"setsockopt", {INT, INT, INT, POINTER, INT}},
    [55] = {"getsockopt", {INT, INT, INT, POINTER, POINTER}},
    [56] = {"clone", {INT, POINTER, POINTER, POINTER, POINTER}},
    [57] = {"fork", {VOID}},
    [58] = {"vfork", {VOID}},
    [59] = {"execve", {STRING, POINTER, POINTER}},
    [60] = {"exit", {INT}},
    [61] = {"wait4", {INT, POINTER, INT, POINTER}},
    [62] = {"kill", {INT, INT}},
    [63] = {"uname", {POINTER}},
    [64] = {"semget", {INT, INT, INT}},
    [65] = {"semop", {INT, POINTER, INT}},
    [66] = {"semctl", {INT, INT, INT, INT}},
    [67] = {"shmdt", {STRING}},
    [68] = {"msgget", {INT, INT}},
    [69] = {"msgsnd", {INT, POINTER, INT, INT}},
    [70] = {"msgrcv", {INT, POINTER, INT, INT, INT}},
    [71] = {"msgctl", {INT, INT, POINTER}},
    [72] = {"fcntl", {INT, INT, INT}},
    [73] = {"flock", {INT, INT}},
    [74] = {"fsync", {INT}},
    [75] = {"fdatasync", {INT}},
    [76] = {"truncate", {STRING, INT}},
    [77] = {"ftruncate", {INT, INT}},
    [78] = {"getdents", {INT, POINTER, INT}},
    [79] = {"getcwd", {STRING, INT}},
    [80] = {"chdir", {STRING}},
    [81] = {"fchdir", {INT}},
    [82] = {"rename", {STRING, STRING}},
    [83] = {"mkdir", {STRING, INT}},
    [84] = {"rmdir", {STRING}},
    [85] = {"creat", {STRING, INT}},
    [86] = {"link", {STRING, STRING}},
    [87] = {"unlink", {STRING}},
    [88] = {"symlink", {STRING, STRING}},
    [89] = {"readlink", {STRING, STRING, INT}},
    [90] = {"chmod", {STRING, INT}},
    [91] = {"fchmod", {INT, INT}},
    [92] = {"chown", {STRING, INT, INT}},
    [93] = {"fchown", {INT, INT, INT}},
    [94] = {"lchown", {STRING, INT, INT}},
    [95] = {"umask", {INT}},
    [96] = {"gettimeofday", {POINTER, POINTER}},
    [97] = {"getrlimit", {INT, POINTER}},
    [98] = {"getrusage", {INT, POINTER}},
    [99] = {"sysinfo", {POINTER}},
    [100] = {"times", {POINTER}},
    [101] = {"ptrace", {INT, INT, POINTER, POINTER}},
    [102] = {"getuid", {VOID}},
    [103] = {"syslog", {INT, STRING, INT}},
    [104] = {"getgid", {VOID}},
    [105] = {"setuid", {INT}},
    [106] = {"setgid", {INT}},
    [107] = {"geteuid", {VOID}},
    [108] = {"getegid", {VOID}},
    [109] = {"setpgid", {INT, INT}},
    [110] = {"getppid", {VOID}},
    [111] = {"getpgrp", {VOID}},
    [112] = {"setsid", {VOID}},
    [113] = {"setreuid", {INT, INT}},
    [114] = {"setregid", {INT, INT}},
    [115] = {"getgroups", {INT, POINTER}},
    [116] = {"setgroups", {INT, POINTER}},
    [117] = {"setresuid", {INT, INT, INT}},
    [118] = {"getresuid", {POINTER, POINTER, POINTER}},
    [119] = {"setresgid", {INT, INT, INT}},
    [120] = {"getresgid", {POINTER, POINTER, POINTER}},
    [121] = {"getpgid", {INT}},
    [122] = {"setfsuid", {INT}},
    [123] = {"setfsgid", {INT}},
    [124] = {"getsid", {INT}},
    [125] = {"capget", {POINTER, POINTER}},
    [126] = {"capset", {POINTER, POINTER}},
    [127] = {"rt_sigpending", {POINTER, INT}},
    [128] = {"rt_sigtimedwait", {POINTER, POINTER, POINTER, INT}},
    [129] = {"rt_sigqueueinfo", {INT, INT, POINTER}},
    [130] = {"rt_sigsuspend", {POINTER}},
    [131] = {"sigaltstack", {POINTER, POINTER}},
    [132] = {"utime", {STRING, POINTER}},
    [133] = {"mknod", {STRING, INT, INT}},
    [134] = {"uselib", {STRING}},
    [135] = {"personality", {INT}},
    [136] = {"ustat", {INT, POINTER}},
    [137] = {"statfs", {STRING, POINTER}},
    [138] = {"fstatfs", {INT, POINTER}},
    [139] = {"sysfs", {INT, STRING, INT}},
    [140] = {"getpriority", {INT, INT}},
    [141] = {"setpriority", {INT, INT, INT}},
    [142] = {"sched_setparam", {INT, POINTER}},
    [143] = {"sched_getparam", {INT, POINTER}},
    [144] = {"sched_setscheduler", {INT, INT, POINTER}},
    [145] = {"sched_getscheduler", {INT}},
    [146] = {"sched_get_priority_max", {INT}},
    [147] = {"sched_get_priority_min", {INT}},
    [148] = {"sched_rr_get_interval", {INT, POINTER}},
    [149] = {"mlock", {POINTER, INT}},
    [150] = {"munlock", {POINTER, INT}},
    [151] = {"mlockall", {INT}},
    [152] = {"munlockall", {VOID}},
    [153] = {"vhangup", {VOID}},
    [154] = {"modify_ldt", {INT, POINTER, INT}},
    [155] = {"pivot_root", {STRING, STRING}},
    [156] = {"_sysctl", {POINTER}},
    [157] = {"prctl", {INT, INT, INT, INT, INT}},
    [158] = {"arch_prctl", {INT, POINTER}},
    [159] = {"adjtimex", {POINTER}},
    [160] = {"setrlimit", {INT, POINTER}},
    [161] = {"chroot", {STRING}},
    [162] = {"sync", {VOID}},
    [163] = {"acct", {STRING}},
    [164] = {"settimeofday", {POINTER, POINTER}},
    [165] = {"mount", {STRING, STRING, STRING, INT, POINTER}},
    [166] = {"umount2", {STRING, INT}},
    [167] = {"swapon", {STRING, INT}},
    [168] = {"swapoff", {STRING}},
    [169] = {"reboot", {INT, INT, INT, POINTER}},
    [170] = {"sethostname", {STRING, INT}},
    [171] = {"setdomainname", {STRING, INT}},
    [172] = {"iopl", {INT}},
    [173] = {"ioperm", {INT, INT, INT}},
    [174] = {"create_module", {VOID}},
    [175] = {"init_module", {POINTER, INT, STRING}},
    [176] = {"delete_module", {STRING, INT}},
    [177] = {"get_kernel_syms", {VOID}},
    [178] = {"query_module", {VOID}},
    [179] = {"quotactl", {INT, STRING, INT, POINTER}},
    [180] = {"nfsservctl", {VOID}},
    [181] = {"getpmsg", {VOID}},
    [182] = {"putpmsg", {VOID}},
    [183] = {"afs_syscall", {VOID}},
    [184] = {"tuxcall", {VOID}},
    [185] = {"security", {VOID}},
    [186] = {"gettid", {VOID}},
    [187] = {"readahead", {INT, INT, INT}},
    [188] = {"setxattr", {STRING, STRING, POINTER, INT, INT}},
    [189] = {"lsetxattr", {STRING, STRING, POINTER, INT, INT}},
    [190] = {"fsetxattr", {INT, STRING, POINTER, INT, INT}},
    [191] = {"getxattr", {STRING, STRING, POINTER, INT}},
    [192] = {"lgetxattr", {STRING, STRING, POINTER, INT}},
    [193] = {"fgetxattr", {INT, STRING, POINTER, INT}},
    [194] = {"listxattr", {STRING, STRING, INT}},
    [195] = {"llistxattr", {STRING, STRING, INT}},
    [196] = {"flistxattr", {INT, STRING, INT}},
    [197] = {"removexattr", {STRING, STRING}},
    [198] = {"lremovexattr", {STRING, STRING}},
    [199] = {"fremovexattr", {INT, STRING}},
    [200] = {"tkill", {INT, INT}},
    [201] = {"time", {POINTER}},
    [202] = {"futex", {POINTER, INT, INT, POINTER, POINTER, INT}},
    [203] = {"sched_setaffinity", {INT, INT, POINTER}},
    [204] = {"sched_getaffinity", {INT, INT, POINTER}},
    [205] = {"set_thread_area", {POINTER}},
    [206] = {"io_setup", {INT, POINTER}},
    [207] = {"io_destroy", {INT}},
    [208] = {"io_getevents", {INT, INT, INT, POINTER, POINTER}},
    [209] = {"io_submit", {INT, INT, POINTER}},
    [210] = {"io_cancel", {INT, POINTER, POINTER}},
    [211] = {"get_thread_area", {POINTER}},
    [212] = {"lookup_dcookie", {INT, STRING, INT, INT}},
    [213] = {"epoll_create", {INT}},
    [214] = {"epoll_ctl_old", {VOID}},
    [215] = {"epoll_wait_old", {VOID}},
    [216] = {"remap_file_pages", {POINTER, INT, INT, INT, INT}},
    [217] = {"getdents64", {INT, POINTER, INT}},
    [218] = {"set_tid_address", {POINTER}},
    [219] = {"restart_syscall", {VOID}},
    [220] = {"semtimedop", {INT, POINTER, INT, POINTER}},
    [221] = {"fadvise64", {INT, INT, INT, INT}},
    [222] = {"timer_create", {INT, POINTER, POINTER}},
    [223] = {"timer_settime", {INT, INT, POINTER, POINTER}},
    [224] = {"timer_gettime", {INT, POINTER}},
    [225] = {"timer_getoverrun", {INT}},
    [226] = {"timer_delete", {INT}},
    [227] = {"clock_settime", {INT, POINTER}},
    [228] = {"clock_gettime", {INT, POINTER}},
    [229] = {"clock_getres", {INT, POINTER}},
    [230] = {"clock_nanosleep", {INT, INT, POINTER, POINTER}},
    [231] = {"exit_group", {INT}},
    [232] = {"epoll_wait", {INT, POINTER, INT, INT}},
    [233] = {"epoll_ctl", {INT, INT, INT, POINTER}},
    [234] = {"tgkill", {INT, INT, INT}},
    [235] = {"utimes", {STRING, POINTER}},
    [236] = {"vserver", {VOID}},
    [237] = {"mbind", {POINTER, INT, INT, POINTER, INT, INT}},
    [238] = {"set_mempolicy", {INT, POINTER, INT}},
    [239] = {"get_mempolicy", {INT, POINTER, INT, POINTER, INT}},
    [240] = {"mq_open", {STRING, INT, INT, POINTER}},
    [241] = {"mq_unlink", {STRING}},
    [242] = {"mq_timedsend", {INT, STRING, INT, INT, POINTER}},
    [243] = {"mq_timedreceive", {INT, STRING, INT, INT, POINTER}},
    [244] = {"mq_notify", {INT, POINTER}},
    [245] = {"mq_getsetattr", {INT, POINTER, POINTER}},
    [246] = {"kexec_load", {INT, INT, POINTER, INT}},
    [247] = {"waitid", {INT, INT, POINTER, INT, POINTER}},
    [248] = {"add_key", {STRING, STRING, POINTER, INT, INT}},
    [249] = {"request_key", {STRING, STRING, STRING, INT}},
    [250] = {"keyctl", {INT, INT, INT, INT, INT}},
    [251] = {"ioprio_set", {INT, INT, INT}},
    [252] = {"ioprio_get", {INT, INT}},
    [253] = {"inotify_init", {VOID}},
    [254] = {"inotify_add_watch", {INT, STRING, INT}},
    [255] = {"inotify_rm_watch", {INT, INT}},
    [256] = {"migrate_pages", {INT, INT, POINTER, POINTER}},
    [257] = {"openat", {INT, STRING, INT, INT}},
    [258] = {"mkdirat", {INT, STRING, INT}},
    [259] = {"mknodat", {INT, STRING, INT, INT}},
    [260] = {"fchownat", {INT, STRING, INT, INT, INT}},
    [261] = {"futimesat", {INT, STRING, POINTER}},
    [262] = {"newfstatat", {INT, STRING, POINTER, INT}},
    [263] = {"unlinkat", {INT, STRING, INT}},
    [264] = {"renameat", {INT, STRING, INT, STRING}},
    [265] = {"linkat", {INT, STRING, INT, STRING, INT}},
    [266] = {"symlinkat", {STRING, INT, STRING}},
    [267] = {"readlinkat", {INT, STRING, STRING, INT}},
    [268] = {"fchmodat", {INT, STRING, INT}},
    [269] = {"faccessat", {INT, STRING, INT}},
    [270] = {"pselect6", {INT, POINTER, POINTER, POINTER, POINTER, POINTER}},
    [271] = {"ppoll", {POINTER, INT, POINTER, POINTER, INT}},
    [272] = {"unshare", {INT}},
    [273] = {"set_robust_list", {POINTER, INT}},
    [274] = {"get_robust_list", {INT, POINTER, POINTER}},
    [275] = {"splice", {INT, POINTER, INT, POINTER, INT, INT}},
    [276] = {"tee", {INT, INT, INT, INT}},
    [277] = {"sync_file_range", {INT, INT, INT, INT}},
    [278] = {"vmsplice", {INT, POINTER, INT, INT}},
    [279] = {"move_pages", {INT, INT, POINTER, POINTER, POINTER, INT}},
    [280] = {"utimensat", {INT, STRING, POINTER, INT}},
    [281] = {"epoll_pwait", {INT, POINTER, INT, INT, POINTER, INT}},
    [282] = {"signalfd", {INT, POINTER, INT}},
    [283] = {"timerfd_create", {INT, INT}},
    [284] = {"eventfd", {INT}},
    [285] = {"fallocate", {INT, INT, INT, INT}},
    [286] = {"timerfd_settime", {INT, INT, POINTER, POINTER}},
    [287] = {"timerfd_gettime", {INT, POINTER}},
    [288] = {"accept4", {INT, POINTER, POINTER, INT}},
    [289] = {"signalfd4", {INT, POINTER, INT, INT}},
    [290] = {"eventfd2", {INT, INT}},
    [291] = {"epoll_create1", {INT}},
    [292] = {"dup3", {INT, INT, INT}},
    [293] = {"pipe2", {POINTER, INT}},
    [294] = {"inotify_init1", {INT}},
    [295] = {"preadv", {INT, POINTER, INT, INT, INT}},
    [296] = {"pwritev", {INT, POINTER, INT, INT, INT}},
    [297] = {"rt_tgsigqueueinfo", {INT, INT, INT, POINTER}},
    [298] = {"perf_event_open", {POINTER, INT, INT, INT, INT}},
    [299] = {"recvmmsg", {INT, POINTER, INT, INT, POINTER}},
    [300] = {"fanotify_init", {INT, INT}},
    [301] = {"fanotify_mark", {INT, INT, INT, INT, STRING}},
    [302] = {"prlimit64", {INT, INT, POINTER, POINTER}},
    [303] = {"name_to_handle_at", {INT, STRING, POINTER, POINTER, INT}},
    [304] = {"open_by_handle_at", {INT, POINTER, INT}},
    [305] = {"clock_adjtime", {INT, POINTER}},
    [306] = {"syncfs", {INT}},
    [307] = {"sendmmsg", {INT, POINTER, INT, INT}},
    [308] = {"setns", {INT, INT}},
    [309] = {"getcpu", {POINTER, POINTER, POINTER}},
    [310] = {"process_vm_readv", {INT, POINTER, INT, POINTER, INT, INT}},
    [311] = {"process_vm_writev", {INT, POINTER, INT, POINTER, INT, INT}},
    [312] = {"kcmp", {INT, INT, INT, INT, INT}},
    [313] = {"finit_module", {INT, STRING, INT}},
    [314] = {"sched_setattr", {INT, POINTER, INT}},
    [315] = {"sched_getattr", {INT, POINTER, INT, INT}},
    [316] = {"renameat2", {INT, STRING, INT, STRING, INT}},
    [317] = {"seccomp", {INT, INT, POINTER}},
    [318] = {"getrandom", {POINTER, INT, INT}},
    [319] = {"memfd_create", {STRING, INT}},
    [320] = {"kexec_file_load", {INT, INT, INT, STRING, INT}},
    [321] = {"bpf", {INT, POINTER, INT}},
    [322] = {"execveat", {INT, STRING, POINTER, POINTER, INT}},
    [323] = {"userfaultfd", {INT}},
    [324] = {"membarrier", {INT, INT}},
    [325] = {"mlock2", {POINTER, INT, INT}},
    [326] = {"copy_file_range", {INT, POINTER, INT, POINTER, INT, INT}},
    [327] = {"preadv2", {INT, POINTER, INT, INT, INT, INT}},
    [328] = {"pwritev2", {INT, POINTER, INT, INT, INT, INT}},
    [329] = {"pkey_mprotect", {POINTER, INT, INT, INT}},
    [330] = {"pkey_alloc", {INT, INT}},
    [331] = {"pkey_free", {INT}},
    [332] = {"statx", {INT, STRING, INT, INT, POINTER}},
    [333] = {"io_pgetevents", {INT, INT, INT, POINTER, POINTER, INT}},
    [334] = {"rseq", {POINTER, INT, INT, INT}},
    // Los syscalls siguientes tienen n√∫meros diferentes en tu sistema
    [424] = {"pidfd_send_signal", {INT, INT, POINTER, INT}},
    [425] = {"io_uring_setup", {INT, POINTER}},
    [426] = {"io_uring_enter", {INT, INT, INT, INT, POINTER, INT}},
    [427] = {"io_uring_register", {INT, INT, POINTER, INT}},
    [428] = {"open_tree", {INT, STRING, INT}},
    [429] = {"move_mount", {INT, STRING, INT, STRING, INT}},
    [430] = {"fsopen", {STRING, INT}},
    [431] = {"fsconfig", {INT, INT, INT, POINTER, INT}},
    [432] = {"fsmount", {INT, INT, INT}},
    [433] = {"fspick", {INT, STRING, INT}},
    [434] = {"pidfd_open", {INT, INT}},
    [435] = {"clone3", {POINTER, INT}},
    [436] = {"close_range", {INT, INT, INT}},
    [437] = {"openat2", {INT, STRING, POINTER, INT}},
    [438] = {"pidfd_getfd", {INT, INT, INT}},
    [439] = {"faccessat2", {INT, STRING, INT, INT}},
    [440] = {"process_madvise", {INT, POINTER, INT, INT, INT}},
    [441] = {"epoll_pwait2", {INT, POINTER, INT, POINTER, INT}},
    [442] = {"mount_setattr", {INT, STRING, INT, POINTER, INT}},
    [443] = {"quotactl_fd", {INT, INT, INT, POINTER}},
    [444] = {"landlock_create_ruleset", {POINTER, INT, INT}},
    [445] = {"landlock_add_rule", {INT, INT, POINTER, INT}},
    [446] = {"landlock_restrict_self", {INT, INT}},
    [447] = {"memfd_secret", {INT}},
    [448] = {"process_mrelease", {INT, INT}},
    [449] = {"futex_waitv", {POINTER, INT, INT, POINTER, INT}},
    [450] = {"set_mempolicy_home_node", {INT, INT, INT, INT}},
    [451] = {"cachestat", {INT, POINTER, POINTER, INT}},
    [452] = {"fchmodat2", {INT, STRING, INT, INT}},
    [453] = {"map_shadow_stack", {INT, INT, INT, INT}},
    [454] = {"futex_wake", {POINTER, INT, INT, INT}},
    [455] = {"futex_wait", {POINTER, INT, INT, INT}},
    [456] = {"futex_requeue", {POINTER, INT, POINTER, INT, INT, INT}},
    [457] = {"statmount", {INT, STRING, INT, POINTER, INT}},
    [458] = {"listmount", {POINTER, INT, POINTER, INT, INT}},
    [459] = {"lsm_get_self_attr", {POINTER, POINTER, INT, INT}},
    [460] = {"lsm_set_self_attr", {POINTER, POINTER, INT, INT}},
    [461] = {"lsm_list_modules", {POINTER, INT, POINTER}}
};